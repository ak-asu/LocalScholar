<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="color-scheme" content="light dark">
  <title>Quizzer</title>
  <link rel="stylesheet" href="popup.css">
</head>
<body>
  <main>
    <header>
      <h1>Quizzer</h1>
      <p class="subtitle">Right-click any text → Quizzer</p>
      <div id="api-warning" class="api-warning" hidden>
        <div id="api-warning-content"></div>
      </div>
      <nav class="tabs" role="tablist">
        <button id="tab-history" class="tab active" role="tab" aria-selected="true" aria-controls="view-history">History</button>
        <button id="tab-settings" class="tab" role="tab" aria-selected="false" aria-controls="view-settings">Settings</button>
      </nav>
    </header>

    <!-- History View (Default) -->
    <section id="view-history" role="tabpanel" aria-labelledby="tab-history">
      <div class="history-section">
        <h2>Summaries</h2>
        <div id="summaries-list" class="item-list">
          <p class="empty-state">No summaries yet. Right-click text → Quizzer: Summarize</p>
        </div>
      </div>

      <div class="history-section">
        <h2>Flashcard Decks</h2>
        <div id="decks-list" class="item-list">
          <p class="empty-state">No decks yet. Right-click text → Quizzer: Create Flashcards</p>
        </div>
      </div>

      <div class="history-section">
        <h2>Reports</h2>

        <!-- Queue Items Section -->
        <div class="queue-section">
          <div class="queue-info">
            <span id="queue-count">0 items in queue</span>
            <button id="clear-queue-btn" type="button" class="btn-text">Clear</button>
          </div>
          <div id="queue-list" class="item-list">
            <p class="empty-state">No items in queue. Right-click → Add to Report Queue</p>
          </div>
          <div style="margin-top: 12px;">
            <label for="report-instructions" style="display: block; font-size: 12px; font-weight: 500; margin-bottom: 4px; color: inherit;">
              Custom Instructions (optional)
            </label>
            <textarea
              id="report-instructions"
              placeholder="e.g., Focus on key findings, use bullet points, keep it concise..."
              rows="3"
              style="width: 100%; padding: 8px; border: 1px solid var(--chrome-border); border-radius: 6px; font-size: 12px; font-family: inherit; resize: vertical; box-sizing: border-box;"
            ></textarea>
          </div>
          <button id="generate-report-btn" type="button" class="btn-primary" disabled>Generate Report from Queue</button>
        </div>

        <!-- Generated Reports Section -->
        <div class="queue-section">
          <h3>Generated Reports</h3>
          <div id="reports-list" class="item-list">
            <p class="empty-state">No reports yet. Generate a report from queue items above.</p>
          </div>
        </div>
      </div>
    </section>

    <!-- Modal for viewing content -->
    <div id="modal-overlay" class="modal-overlay" hidden>
      <div class="modal">
        <div class="modal-header">
          <h3 id="modal-title" class="modal-title">View Content</h3>
          <button id="modal-close" class="modal-close" aria-label="Close">&times;</button>
        </div>
        <div class="modal-body">
          <div id="modal-content" class="modal-content"></div>
        </div>
        <div class="modal-footer">
          <button id="modal-copy-btn" type="button" class="btn-secondary">Copy</button>
          <button id="modal-download-btn" type="button" class="btn-secondary">Download</button>
          <button id="modal-ok-btn" type="button" class="btn-primary">OK</button>
        </div>
      </div>
    </div>

    <!-- Settings View -->
    <section id="view-settings" role="tabpanel" aria-labelledby="tab-settings" hidden>
      <div class="settings-group">
        <h2>Summarization</h2>
        <label for="sum-type">
          <span>Type</span>
          <select id="sum-type" name="sum-type">
            <option value="tldr">TL;DR</option>
            <option value="key-points" selected>Key Points</option>
            <option value="headline">Headline</option>
            <option value="teaser">Teaser</option>
          </select>
        </label>
        <label for="sum-length">
          <span>Length</span>
          <select id="sum-length" name="sum-length">
            <option value="short">Short</option>
            <option value="medium" selected>Medium</option>
            <option value="long">Long</option>
          </select>
        </label>
        <label for="sum-format">
          <span>Format</span>
          <select id="sum-format" name="sum-format">
            <option value="markdown" selected>Markdown</option>
            <option value="plain-text">Plain Text</option>
          </select>
        </label>
        <label for="output-language">
          <span>Output Language</span>
          <select id="output-language" name="output-language">
            <option value="en" selected>English</option>
            <option value="es">Spanish</option>
            <option value="ja">Japanese</option>
            <option value="fr">French</option>
            <option value="de">German</option>
          </select>
        </label>
      </div>

      <div class="settings-group">
        <h2>Flashcards</h2>
        <label for="fc-count">
          <span>Count</span>
          <select id="fc-count" name="fc-count">
            <option value="5" selected>5</option>
            <option value="10">10</option>
            <option value="15">15</option>
          </select>
        </label>
        <label for="fc-difficulty">
          <span>Difficulty</span>
          <select id="fc-difficulty" name="fc-difficulty">
            <option value="easy">Easy</option>
            <option value="medium" selected>Medium</option>
            <option value="hard">Hard</option>
          </select>
        </label>
        <label for="fc-language">
          <span>Output Language</span>
          <select id="fc-language" name="fc-language">
            <option value="en" selected>English</option>
            <option value="es">Spanish</option>
            <option value="ja">Japanese</option>
          </select>
        </label>
      </div>

      <div class="settings-group">
        <h2>Translation</h2>
        <label for="translation-target-lang">
          <span>Target Language</span>
          <select id="translation-target-lang" name="translation-target-lang">
            <option value="en">English</option>
            <option value="es" selected>Spanish</option>
            <option value="ja">Japanese</option>
            <option value="fr">French</option>
            <option value="de">German</option>
            <option value="zh">Chinese (Simplified)</option>
            <option value="ko">Korean</option>
            <option value="it">Italian</option>
            <option value="pt">Portuguese</option>
            <option value="ru">Russian</option>
          </select>
        </label>
      </div>

      <div class="settings-group">
        <h2>Rewriter</h2>
        <label for="rewriter-tone">
          <span>Tone</span>
          <select id="rewriter-tone" name="rewriter-tone">
            <option value="more-formal">More Formal</option>
            <option value="as-is" selected>As-Is</option>
            <option value="more-casual">More Casual</option>
          </select>
        </label>
        <label for="rewriter-length">
          <span>Length</span>
          <select id="rewriter-length" name="rewriter-length">
            <option value="shorter">Shorter</option>
            <option value="as-is" selected>As-Is</option>
            <option value="longer">Longer</option>
          </select>
        </label>
        <label for="rewriter-format">
          <span>Format</span>
          <select id="rewriter-format" name="rewriter-format">
            <option value="as-is" selected>As-Is</option>
            <option value="markdown">Markdown</option>
            <option value="plain-text">Plain Text</option>
          </select>
        </label>
      </div>

      <div class="settings-group">
        <h2>Performance</h2>
        <label class="checkbox-label">
          <input type="checkbox" id="enable-caching" checked>
          <span>Enable Caching</span>
        </label>
        <label for="cache-expiration">
          <span>Cache Expiration</span>
          <select id="cache-expiration" name="cache-expiration">
            <option value="1">1 hour</option>
            <option value="24" selected>24 hours</option>
            <option value="168">7 days</option>
            <option value="0">Never</option>
          </select>
        </label>
        <label for="chunk-size">
          <span>Chunk Size</span>
          <select id="chunk-size" name="chunk-size">
            <option value="2000">2K chars</option>
            <option value="4000" selected>4K chars</option>
            <option value="6000">6K chars</option>
            <option value="8000">8K chars</option>
          </select>
        </label>
      </div>

      <div class="settings-group">
        <h2>Auto-Start</h2>
        <label class="checkbox-label">
          <input type="checkbox" id="auto-summarize">
          <span>Auto-summarize on page load (runs in background)</span>
        </label>
        <label class="checkbox-label">
          <input type="checkbox" id="auto-flashcards">
          <span>Auto-generate flashcards on page load (runs in background)</span>
        </label>
      </div>

      <div class="settings-group">
        <h2>Data Management</h2>
        <div class="btn-group">
          <button id="export-data" type="button" class="btn-secondary">Export Data</button>
          <button id="import-data" type="button" class="btn-secondary">Import Data</button>
          <input type="file" id="import-file" accept=".json" style="display: none;">
        </div>
        <div class="btn-group">
          <button id="clear-cache-btn" type="button" class="btn-secondary">Clear Cache</button>
          <button id="clear-all-data-btn" type="button" class="btn-danger">Clear All Data</button>
        </div>
      </div>

      <div id="status" class="status" role="status" aria-live="polite"></div>
    </section>
  </main>
  <script src="popup.js" type="module"></script>
</body>
</html>
